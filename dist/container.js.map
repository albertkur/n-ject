{"version":3,"file":"container.js","sourceRoot":"","sources":["../src/container.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,2CAAgC;AAEhC,2CAAqC;AACrC,2DAAqD;AACrD,2CAAqC;AAErC,6CAAuC;AAGvC,2CAAwD;AAExD,SAAS;AACT;IAAuC,6BAAS;IAK5C;QAAA,YAEI,kBAAM,oBAAS,CAAC,IAAI,EAAE,IAAI,4BAAiB,EAAE,EAAE,IAAI,CAAC,SACvD;QANO,qBAAe,GAAG,KAAK,CAAC;;IAMhC,CAAC;IAGM,4BAAQ,GAAf,UAAgB,GAAW,EAAE,SAAmB,EAAE,SAAoB;QAElE,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC;YACrB,MAAM,IAAI,uCAAyB,CAAC,UAAU,CAAC,CAAC;QAEpD,qBAAK,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,cAAc,EAAE,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,CAAC,mBAAmB,EAAE,EAAxB,CAAwB,CAAC,CAAC;QACzE,qBAAK,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,cAAc,EAAE,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,OAAO,CAAC,KAAK,UAAU,EAAvB,CAAuB,CAAC,CAAC;QACpF,qBAAK,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,cAAc,EAAE,CAAC;QAE/C,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,GAAG,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;QAC3D,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IAEM,2BAAO,GAAd,UAAe,kBAAsC;QAEjD,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC;YACrB,MAAM,IAAI,uCAAyB,CAAC,SAAS,CAAC,CAAC;QAEnD,qBAAK,CAAC,kBAAkB,EAAE,oBAAoB,CAAC,CAAC,cAAc,EAAE,CAAC;QACjE,kBAAkB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACjC,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IAEM,+BAAW,GAAlB;QAEI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC;YACtB,MAAM,IAAI,uCAAyB,CAAC,aAAa,CAAC,CAAC;QAEvD,MAAM,CAAC,IAAI,qBAAU,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IACxD,CAAC;IAEM,6BAAS,GAAhB;QAEI,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC;YACrB,MAAM,IAAI,uCAAyB,CAAC,WAAW,CAAC,CAAC;QAErD,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,EAAE,CAAC;QAC7C,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;IAChC,CAAC;IACL,gBAAC;AAAD,CAAC,AAlDD,CAAuC,oBAAS,GAkD/C","sourcesContent":["import given from \"n-defensive\";\nimport Scope from \"./scope\";\nimport BaseScope from \"./base-scope\";\nimport ComponentRegistry from \"./component-registry\";\nimport ScopeType from \"./scope-type\";\nimport Lifestyle from \"./lifestyle\";\nimport ChildScope from \"./child-scope\";\nimport ComponentInstaller from \"./component-installer\";\nimport Registry from \"./registry\";\nimport { InvalidOperationException } from \"n-exception\";\n\n// public\nexport default class Container extends BaseScope implements Registry\n{\n    private _isBootstrapped = false;\n    \n    \n    public constructor()\n    {\n        super(ScopeType.Root, new ComponentRegistry(), null);\n    }\n\n\n    public register(key: string, component: Function, lifestyle: Lifestyle): Container\n    {\n        if (this._isBootstrapped)\n            throw new InvalidOperationException(\"register\");    \n        \n        given(key, \"key\").ensureHasValue().ensure(t => !t.isEmptyOrWhiteSpace());\n        given(component, \"component\").ensureHasValue().ensure(t => typeof t === \"function\");\n        given(lifestyle, \"lifestyle\").ensureHasValue();\n        \n        this.componentRegistry.register(key, component, lifestyle);\n        return this;\n    }\n    \n    public install(componentInstaller: ComponentInstaller): Container\n    {\n        if (this._isBootstrapped)\n            throw new InvalidOperationException(\"install\");    \n        \n        given(componentInstaller, \"componentInstaller\").ensureHasValue();\n        componentInstaller.install(this);\n        return this;\n    }\n\n    public createScope(): Scope\n    {\n        if (!this._isBootstrapped)\n            throw new InvalidOperationException(\"createScope\");\n        \n        return new ChildScope(this.componentRegistry, this);\n    }\n\n    public bootstrap(): void\n    {\n        if (this._isBootstrapped)\n            throw new InvalidOperationException(\"bootstrap\");\n        \n        this.componentRegistry.verifyRegistrations();\n        this._isBootstrapped = true;\n    }\n}"]}